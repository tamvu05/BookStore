<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<div id="data-attribute"     data-current-page="<%= currentPage %>"     data-total-page="<%= totalPage %>"    
    data-total-item="<%= totalItem %>"     data-total-item-per-page="<%= totalItemPerPage %>"    
    data-page-limit="<%= PAGE_LIMIT %>"></div>

<div class="table-responsive-wrapper">
    <table class="table table-striped table-hover align-middle">
        <thead>
            <tr>
                <th>Mã</th>
                <th>Ảnh bìa</th>
                <th>
                    <i class="sortable" data-sort="TenSach">Sách</i>
                </th>
                <th>Thông tin</th>
                <th>Tồn kho</th>
                <th>Giá bán</th>
                <% if (isManager) { %>
                <th class="text-center">Thao tác</th>
                <% } %>
            </tr>
        </thead>
        <tbody>

            <% if (books.length> 0) { %>

                <% books.forEach((book, index)=> { %>

                    <tr data-id="<%= book.MaSach %>">
                        <td>
                            #S<%= book.MaSach %>
                        </td>
                        <td>
                            <a href="<%= book.HinhAnh %>" class="book-cover-link" target="_blank" rel="noopener noreferrer">
                                <img src="<%= book.HinhAnh %>" class="book-cover-thumb" alt="<%= book.TenSach %>"
                                    onerror="this.onerror=null; this.src='/images/book.jpg'; this.parentElement.href='/images/book.jpg';">
                            </a>
                        </td>
                        <td class="name font-weight-bold">
                            <%= book.TenSach %>
                        </td>
                        <td class="book-info">
                            <div class="info-line"><strong>Tác giả:</strong> <%= book.TenTG %></div>
                            <div class="info-line"><strong>Thể loại:</strong> <%= book.TenTL %></div>
                            <div class="info-line"><strong>NXB:</strong> <%= book.TenNXB %></div>
                        </td>
                        <td class="desc text-muted">
                            <%= book.SoLuongTon %>
                        </td>
                        <td class="desc text-muted">
                            <%= formatPrice(book.DonGia) %>
                        </td>
                        <% if (isManager) { %>
                        <td class="action-col text-center">
                            <button class="btn-show-modal-update btn action-btn edit-btn" title="Chỉnh sửa">
                                <i class="fa-regular fa-pen-to-square"></i>
                            </button>
                            <button class="btn-delete-entity btn action-btn delete-btn" title="Xóa">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </td>
                        <% } %>
                    </tr>
                    <% }) %>

                        <% } else { %>

                            <tr class="no-data">
                                <td colspan="<%= isManager ? 6 : 5 %>" class="text-center py-4">
                                    Không có dữ liệu...
                                </td>
                            </tr>

                            <% } %>

        </tbody>
    </table>
</div>

<style>
    /* --- Định nghĩa Kích thước Ảnh Bìa --- */
    .book-cover-thumb {
        width: 80px;
        /* Chiều rộng cố định */
        height: 120px;
        /* Chiều cao cố định */

        /* Đảm bảo ảnh không bị méo và lấp đầy khung hình */
        object-fit: cover;

        /* Đặt border hoặc box-shadow nhẹ để làm nổi bật (tùy chọn) */
        border: 1px solid #ddd;
        border-radius: 4px;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .book-cover-thumb:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    /* --- Style cho cột thông tin gộp --- */
    .book-info {
        font-size: 0.9rem;
        line-height: 1.4;
    }

    .book-info .info-line {
        margin-bottom: 0.2rem;
    }

    .book-info .info-line:last-child {
        margin-bottom: 0;
    }

    .book-info strong {
        color: #6c757d;
        font-weight: 600;
        font-size: 0.85rem;
    }
</style>